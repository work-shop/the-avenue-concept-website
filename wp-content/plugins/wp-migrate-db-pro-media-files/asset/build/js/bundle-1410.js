!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";var n=i(1);n.keys().forEach(function(e){n(e)})},function(e,t,i){var n={"./js/script.js":2,"./sass/styles.scss":3};function o(e){return i(r(e))}function r(e){var t=n[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}o.keys=function(){return Object.keys(n)},o.resolve=r,e.exports=o,o.id=1},function(e,t){window.jQuery;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.wpmdb=window.wpmdb||{},wpmdb.mediaFiles={remote_media_files_unavailable:!1},function(e,t){var n=0,o=e("#mf-select-subsites-section"),r=e("#mf-select-subsites");Object.size||(Object.size=function(e){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i}),Object.keys||(Object.keys=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=n.length;return function(r){if("object"!==(void 0===r?"undefined":i(r))&&("function"!=typeof r||null===r))throw new TypeError("Object.keys called on non-object");var a,s,m=[];for(a in r)e.call(r,a)&&m.push(a);if(t)for(s=0;s<o;s++)e.call(r,n[s])&&m.push(n[s]);return m}}());var a=function(){e("#media-files").attr("data-available","0"),e("#media-files").prop("checked",!1),e("#media-files").attr("disabled","disabled"),e(".media-files").addClass("disabled"),e(".media-files-options .expandable-content").hide()},s=function(i){var n=t.functions.wpmdb_migration_type();if(-1===e.inArray(n,["savefile","find_replace","import"])){if(e(".media-files-options").show(),e(".media-files-push").hide(),i)return e(".media-files-options ul").hide(),e(".media-migration-unavailable").show(),void a();if(void 0!==t.mediaFiles.remote_connection_data&&wpmdb_data.media_files_version!==t.mediaFiles.remote_connection_data.media_files_version)return e(".media-files-remote-location").html(t.mediaFiles.remote_connection_data.url),e(".media-file-remote-version").html(t.mediaFiles.remote_connection_data.media_files_version),e(".media-files-different-plugin-version-notice").show(),void a();if("true"===wpmdb_data.is_multisite){var s=function(){var e={};"pull"===t.functions.wpmdb_migration_type()?void 0!==t.mediaFiles.remote_connection_data&&void 0!==t.mediaFiles.remote_connection_data.subsites&&(e=t.mediaFiles.remote_connection_data.subsites):void 0!==wpmdb_data.subsites&&(e=wpmdb_data.subsites);return e}(),m=e("#_mf-selected-subsites"),_=e("#mf-selected-subsites").val();"pull"===n&&0<Object.size(s)&&m.length&&(_=e.parseJSON(m.val()),m.remove()),t.functions.update_multiselect("#mf-selected-subsites",s,_),e.wpmdb.apply_filters("wpmdbmf_enable_select_subsites",!0)?o.show():(r.prop("checked",!1),o.hide()),r.change(),u()}e(".media-files-options ul").show(),e(".media-migration-unavailable").hide(),e(".media-files-different-plugin-version-notice").hide(),e("#media-files").removeAttr("disabled"),e(".media-files").removeClass("disabled"),e("#media-files").attr("data-available","1")}else e(".media-files-options").hide()};function m(i){if(0===Object.size(i.files_to_migrate))return delete i.files_to_migrate,delete i.total_size,setTimeout(function(){e.wpmdb.do_action("wpmdbmf_media_transfer_complete")},100*t.mediaFiles.remote_connection_data.media_files_max_file_uploads),t.common.next_step_in_migration={fn:t.functions.finalise_media_migration,args:[i]},void t.functions.execute_next_step();var o=[],r=0,a=0;if(e.each(i.files_to_migrate,function(e,s){if("push"===t.functions.wpmdb_migration_type()&&s>n){var m=wpmdbmf_strings.file_too_large+" "+e+" (#124mf)<br>";t.common.non_fatal_errors+=m}else if(o.length){if(r+s>i.bottleneck||a>=t.mediaFiles.remote_connection_data.media_files_max_file_uploads)return!1;o.push(e),r+=s}else o.push(e),r+=s;delete i.files_to_migrate[e],++i.media_progress_image_number,++a}),!t.common.migration_error)return o.length?void e.ajax({url:ajaxurl,type:"POST",dataType:"text",cache:!1,data:{action:"wpmdbmf_migrate_media",migration_state_id:t.migration_state_id,file_chunk:o,nonce:wpmdb_data.nonces.migrate_media},error:function(e,i,n){t.current_migration.setState(wpmdbmf_strings.migration_failed,t.functions.wpmdbGetAjaxErrors(wpmdbmf_strings.migration_failed,"(#102mf)",e.responseText,e),"error"),console.log(e),console.log(i),console.log(n),t.common.migration_error=!0,t.functions.migration_complete_events()},success:function(n){var o=n;if(n=t.functions.wpmdb_parse_json(e.trim(n)))if(void 0===n.wpmdb_error||1!==n.wpmdb_error){if(void 0!==n.wpmdb_non_fatal_error&&1===n.wpmdb_non_fatal_error&&(t.common.non_fatal_errors+=n.body),n.transfers&&n.transfers.length){var a=0;e.each(n.transfers,function(e,i){setTimeout(function(){t.current_migration.model.getStageModel("media").setItemComplete(i.file)},a),a+=50})}i.media_progress+=r,t.common.next_step_in_migration={fn:m,args:[i]},t.functions.execute_next_step()}else d(n.body);else d(o)}}):(t.common.next_step_in_migration={fn:m,args:[i]},void t.functions.execute_next_step());t.functions.migration_complete_events()}function d(e){t.current_migration.setState(wpmdbmf_strings.migration_failed,t.functions.wpmdbGetAjaxErrors("","",e),"error"),t.common.migration_error=!0,t.functions.migration_complete_events()}function c(){return t.functions.is_media_migration()}function l(i,n){return"savefile"!==t.functions.wpmdb_migration_type()&&e("#media-files").is(":checked")&&"true"===wpmdb_data.is_multisite&&r.is(":checked")&&null===e("#mf-selected-subsites").val()&&(alert(wpmdbmf_strings.please_select_a_subsite),i=!1),i}function f(){var t=e('input[name="media_migration_option"][value="compare-remove"]');e(t).is(":checked")?e(".compare-remove-warning").show():e(".compare-remove-warning").hide()}function u(){var i=e(".mf-selected-subsites-tables-differ"),n=e("#mf-selected-subsites").val(),o=e.wpmdb.apply_filters("wpmdb_get_tables_to_migrate",null,null);if("true"===wpmdb_data.is_multisite&&r.is(":checked")&&void 0!==n&&null!==n&&void 0!==o&&null!==o&&0<o.length){var a=e.wpmdb.apply_filters("wpmdb_get_table_prefix",null,null),s=!1;e.each(o,function(i,o){if(t.functions.table_is(a,"posts",o)||t.functions.table_is(a,"postmeta",o)){var r=t.functions.subsite_for_table(a,o);if(0>e.inArray(r.toString(),n))return s=!0,!1}}),s?i.show():i.hide()}else i.hide()}function p(i){!0===c()&&-1===e.inArray(t.functions.wpmdb_migration_type(),["savefile","find_replace","import"])&&t.current_migration.model.addStage("media",[],i.dataType,{strings:{itemsName:wpmdb_strings.files}})}t.functions.prepare_remove_all_files=function(){t.mediaFiles.connection_info=e.trim(e(".pull-push-connection-info").val()).split("\n");var i=e('input[name="media_migration_option"]:checked').val();if(t.current_migration.model.setActiveStage("media"),"entire"===i){var n="removing_all_files_"+t.functions.wpmdb_migration_type();t.current_migration.setText(wpmdbmf_strings[n]);var o={remove_files:1,compare:0,offset:0};o.next_step_in_migration=t.functions.prepare_determine_media,t.common.next_step_in_migration={fn:t.functions.remove_files_recursive,args:[o]},t.functions.execute_next_step()}else t.common.next_step_in_migration={fn:t.functions.prepare_determine_media},t.functions.execute_next_step()},t.functions.remove_files_recursive=function(i){if(0!==i.remove_files){t.mediaFiles.connection_info=e.trim(e(".pull-push-connection-info").val()).split("\n");var n=i;e.ajax({url:ajaxurl,type:"POST",dataType:"text",cache:!1,data:{action:"wpmdbmf_remove_files_recursive",migration_state_id:t.migration_state_id,compare:i.compare,offset:JSON.stringify(i.offset),nonce:wpmdb_data.nonces.remove_files_recursive},error:function(e,i,n){t.current_migration.setState(wpmdbmf_strings.migration_failed,t.functions.wpmdbGetAjaxErrors(wpmdbmf_strings.error_determining,"(#101mf)",e.responseText,e),"error"),console.log(e),console.log(i),console.log(n),t.common.migration_error=!0,t.functions.migration_complete_events()},success:function(o){var r=o;(i=t.functions.wpmdb_parse_json(e.trim(o)))?void 0===i.wpmdb_error||1!==i.wpmdb_error?(void 0!==i.wpmdb_non_fatal_error&&1===i.wpmdb_non_fatal_error&&(t.common.non_fatal_errors+=i.body),i.next_step_in_migration=n.next_step_in_migration,t.common.next_step_in_migration={fn:t.functions.remove_files_recursive,args:[i]},t.functions.execute_next_step()):d(i.body):d(r)}})}else!1!==i.next_step_in_migration?(t.common.next_step_in_migration={fn:i.next_step_in_migration},t.functions.execute_next_step()):t.functions.wpmdb_call_next_hook()},t.functions.prepare_determine_media=function(){t.mediaFiles.connection_info=e.trim(e(".pull-push-connection-info").val()).split("\n"),n=0;var i=0,o=0,r=e('input[name="media_migration_option"]:checked').val();t.current_migration.setText("0% - "+wpmdbmf_strings.determining),"compare-remove"===r&&(r="compare",i=1),"entire"===r&&(o=1);var a={};e.ajax({url:ajaxurl,type:"POST",dataType:"text",cache:!1,data:{action:"wpmdbmf_prepare_determine_media",migration_state_id:t.migration_state_id,nonce:wpmdb_data.nonces.prepare_determine_media},error:function(e,i,n){t.current_migration.setState(wpmdbmf_strings.migration_failed,t.functions.wpmdbGetAjaxErrors(wpmdbmf_strings.error_determining,"(#101mf)",e.responseText,e),"error"),console.log(e),console.log(i),console.log(n),t.common.migration_error=!0,t.functions.migration_complete_events()},success:function(r){var s=r;(a=t.functions.wpmdb_parse_json(e.trim(r)))?void 0===a.wpmdb_error||1!==a.wpmdb_error?(n=a.remote_max_upload_size,a.determine_progress=0,a.remove_local_media=i,a.copy_entire_media=o,t.common.next_step_in_migration={fn:t.functions.determine_media_to_migrate_recursive,args:[a]},t.functions.execute_next_step()):d(a.body):d(s)}})},t.functions.determine_media_to_migrate_recursive=function(i){if(i.determine_progress>=i.attachment_count)return t.common.next_step_in_migration={fn:t.functions.media_successfully_determined,args:[i]},void t.functions.execute_next_step();t.mediaFiles.connection_info=e.trim(e(".pull-push-connection-info").val()).split("\n"),e.ajax({url:ajaxurl,type:"POST",dataType:"text",cache:!1,data:{action:"wpmdbmf_determine_media_to_migrate_recursive",migration_state_id:t.migration_state_id,determine_progress:i.determine_progress,attachment_count:i.attachment_count,remote_uploads_url:i.remote_uploads_url,remove_local_media:i.remove_local_media,copy_entire_media:i.copy_entire_media,blogs:i.blogs,attachment_batch_limit:i.attachment_batch_limit,nonce:wpmdb_data.nonces.determine_media_to_migrate_recursive},error:function(e,i,n){t.current_migration.setState(wpmdbmf_strings.migration_failed,wpmdbmf_strings.error_determining+" (#101mf)","error"),console.log(e),console.log(i),console.log(n),t.common.migration_error=!0,t.functions.migration_complete_events()},success:function(n){var o=n;if(n=t.functions.wpmdb_parse_json(e.trim(n)))if(void 0===n.wpmdb_error||1!==n.wpmdb_error){i.blogs=n.blogs,i.determine_progress=n.determine_progress,i.total_size=i.total_size||0,i.total_size+=n.total_size,i.files_to_migrate=i.files_to_migrate||{},_.each(n.files_to_migrate,function(e,n){i.files_to_migrate[n]=e,t.current_migration.model.addStageItem("media",n,parseInt(e/1024))}),t.current_migration.fixProgressStageWidthForScrollBar();var r=Math.min(100,100*i.determine_progress/i.attachment_count),a=Math.floor(r);e(".migration-progress-stage-container[data-stage=media]").addClass("determining-media"),e(".progress-bar",".stage-progress.media").width(r+"%"),t.current_migration.setText(a+"% - "+wpmdbmf_strings.determining),t.common.next_step_in_migration={fn:t.functions.determine_media_to_migrate_recursive,args:[i]},t.functions.execute_next_step()}else d(n.body);else d(o)}})},t.functions.media_successfully_determined=function(i){if(void 0!==i.wpmdb_error&&1===i.wpmdb_error)return t.common.non_fatal_errors+=data.body,t.common.next_step_in_migration={fn:t.functions.wpmdb_call_next_hook},void t.functions.execute_next_step();i.media_progress=0,i.media_progress_image_number=0,i.bottleneck=wpmdb_data.max_request,i.files_to_migrate=i.files_to_migrate||{};var n="migrate_media_files_"+t.functions.wpmdb_migration_type();t.current_migration.setText(wpmdbmf_strings[n]),e(".migration-progress-stage-container[data-stage=media]").removeClass("determining-media"),t.common.next_step_in_migration={fn:m,args:[i]},t.functions.execute_next_step()},t.functions.finalise_media_migration=function(e){if(1===e.remove_local_media){var i="removing_files_"+t.functions.wpmdb_migration_type();return t.current_migration.setText(wpmdbmf_strings[i]),(e={}).remove_files=1,e.compare=1,e.offset="",e.next_step_in_migration=!1,t.common.next_step_in_migration={fn:t.functions.remove_files_recursive,args:[e]},void t.functions.execute_next_step()}t.functions.wpmdb_call_next_hook()},t.functions.is_media_migration=function(){return!("1"!==e("#media-files").attr("data-available")||!e("#media-files").is(":checked"))},e(document).ready(function(){-1!==e.inArray(t.functions.wpmdb_migration_type(),["savefile","find_replace","import"])&&e(".media-files-options").hide(),e.wpmdb.add_action("move_connection_info_box",function(){s(t.mediaFiles.remote_media_files_unavailable),t.functions.wpmdb_toggle_migration_action_text()}),e.wpmdb.add_action("verify_connection_to_remote_site",function(e){t.mediaFiles.remote_connection_data=e,t.mediaFiles.remote_media_files_unavailable=void 0===e.media_files_available,s(t.mediaFiles.remote_media_files_unavailable)}),e.wpmdb.add_action("wpmdbmst_select_subsite_changed",function(){s(t.mediaFiles.remote_media_files_unavailable)}),e.wpmdb.add_filter("wpmdb_before_migration_complete_hooks",function(i){return!1===c()||-1===e.inArray(t.functions.wpmdb_migration_type(),["push","pull"])?i:(i.push(t.functions.prepare_remove_all_files),i)}),e("body").on("change","#mf-select-subsites",function(){e.wpmdb.do_action("wpmdbmf_selected_subsites_changed")}),e("body").on("change","#mf-selected-subsites",function(){e.wpmdb.do_action("wpmdbmf_selected_subsites_changed")}),e.wpmdb.add_filter("wpmdb_migration_profile_ready",l),e.wpmdb.add_action("wpmdb_tables_to_migrate_changed",u),e.wpmdb.add_action("wpmdbmf_selected_subsites_changed",u),e.wpmdb.add_action("wpmdb_add_migration_stages",p),e('input[name="media_migration_option"]').change(function(){f()}),f()})}(jQuery,wpmdb)},function(e,t){window.jQuery}]);
//# sourceMappingURL=bundle-1410.js.map